var PROGRESS_COOKIE_NAME="progressally-progress-info";var PROGRESS_OBJECTIVE_COOKIE_NAME="progressally-objective-info";var PROGRESS_COOKIE_DAYS=3650;jQuery(document).ready(function(au){function K(aQ,aT,aS,aU){for(var aR=0;aR<aQ.length;++aR){var aN=au(aQ[aR]),aP=aN.attr("pa-dep-value"),aO=aN.attr("pa-dep-value-not"),aV;if(typeof aP!==typeof undefined&&aP!==false){aV=aP.split(",");if(au.inArray(aT,aV)>=0){aS(aN)}else{aU(aN)}}if(typeof aO!==typeof undefined&&aO!==false){aV=aO.split(",");if(au.inArray(aT,aV)<0){aS(aN)}else{aU(aN)}}}}au(document).on("change","[pa-dep-source]",function(){var aN=au(this),aQ="no",aP=aN.attr("pa-dep-source"),aO=au('[pa-dep="'+aP+'"]');if(aN.attr("type")==="checkbox"){if(aN.is(":checked")){aQ="yes"}}else{aQ=aN.val()}if(aQ){aQ=aQ.replace(/\"/g,'\\"')}K(aO.filter("[hide-toggle]"),aQ,function(aR){aR.show()},function(aR){aR.hide()});K(aO.filter("[readonly-toggle]"),aQ,function(aR){aR.prop("readonly",false)},function(aR){aR.prop("readonly",true)});K(aO.filter("[disable-toggle]"),aQ,function(aR){aR.prop("disabled",false)},function(aR){aR.prop("disabled",true)})});if("yes"!==progressally_update.disable_track){if(progressally_update.user>0&&progressally_update.post_id>0){var s={action:"progressally_track_page_access",post_id:progressally_update.post_id,progressally_update_nonce:progressally_update.progressally_update_nonce};au.ajax({type:"POST",url:progressally_update.ajax_url,data:s,success:false})}}var aw=false;au("html").on("touchstart",function(){aw=false});au("html").on("touchmove",function(){aw=true});function o(aP,aN,aO){if(aP.type==="touchend"){if(aw){return false}}return aO(aP,aN)}function an(aN,aO){au(aN).each(function(aR,aS){var aQ=au(aS),aP=aQ.attr("progressally-click-binded");if(typeof aP===typeof undefined||aP===false){aQ.bind("touchend click",function(aT){return o(aT,this,aO)});aQ.attr("progressally-click-binded","yes")}})}au(document).on("change",".progressally-update",function(aN){ap(au(this))});function L(aS){var aQ={},aR=aS.find("input"),aO=true,aT;for(aT=0;aT<aR.length;++aT){var aP=au(aR[aT]),aN=aP.attr("type"),aU=aP.attr("name");if(typeof aU!==typeof undefined&&aU!==false&&"radio"===aN){if(!(aU in aQ)){if(aS.find('input[name="'+aU+'"]:checked').length===0){aS.find('input[name="'+aU+'"]').attr("progressally-error","need-input");aO=false}aQ[aU]=true}}}return aO}au(document).on("change",".progressally-quiz input",function(aP){var aO=au(this),aN=aO.parents(".progressally-quiz"),aQ=aO.attr("name");if(typeof aQ!==typeof undefined&&aQ!==false){aN.find('input[name="'+aQ+'"]').attr("progressally-error",false)}});function ad(aR,aQ){var aT=au(aQ),aN=aT.parents(".progressally-quiz-container"),aO=aN.find(".progressally-quiz"),aP=parseInt(aO.attr("post-id")),aS=null,aU;if(!L(aN)){return false}aU=aO.serialize();aU=aU.replace(/=/g,"|-|");aN.find(".progressally-quiz-submit-button").hide();aN.find(".progressally-quiz-wait-overlay").show();aS={action:"progressally_submit_quiz",p:aP,input:aU,progressally_update_nonce:progressally_update.progressally_update_nonce};au.ajax({type:"POST",url:progressally_update.ajax_url,data:aS,cache:false,dataType:"json",success:function(aV){try{ac(aN,aP,aV)}catch(aW){}aN.find(".progressally-quiz-wait-overlay").hide()}});aR.stopPropagation();return false}function J(aR,aQ){var aT=au(aQ),aN=aT.parents(".progressally-quiz-container"),aO=aN.find(".progressally-quiz"),aP=parseInt(aO.attr("post-id")),aS=null;au(".progressally-quiz-reset-button-container-"+aP).hide();aN.find(".progressally-quiz-wait-overlay").show();aS={action:"progressally_reset_quiz",p:aP,progressally_update_nonce:progressally_update.progressally_update_nonce};au.ajax({type:"POST",url:progressally_update.ajax_url,data:aS,cache:false,dataType:"json",success:function(aU){try{P(aP,aU)}catch(aV){}aN.find(".progressally-quiz-wait-overlay").hide()}});aR.stopPropagation();return false}function G(aO){var aS=au('.progressally-update[post-id="'+aO+'"]'),aP=au('.progressally-objective-table[progressally-post-id="'+aO+'"]'),aN={},aQ,aR=0;if(aS.length>0){aR=aS.filter(":checked").length;aQ=aR/aS.length;if(aP.length>0){aR=aR/aP.length}aE(aO,aQ,aR)}aS.each(function(aV,aX){var aU=au(aX),aT=aU.attr("key"),aW=aU.is(":checked");aN[aT]=aW});return aN}var aq={};function ar(aO,aN){var aQ={action:"progressally_update_progress",p:aO,v:aN,progressally_update_nonce:progressally_update.progressally_update_nonce};if(!(aO in aq)){aq[aO]=0}var aP=++aq[aO];au.ajax({type:"POST",url:progressally_update.ajax_url,data:aQ,success:function(aS){try{if(aq[aO]===aP){var aR=JSON.parse(aS);z(aO,aR);aq[aO]=0}}catch(aT){}}})}function ap(aR){var aS=aR,aP=parseInt(aS.attr("post-id")),aQ=aS.attr("key"),aO=aS.val(),aN={};if(aS.is('[type="checkbox"]')){aO=aS.is(":checked")?true:false;au('.progressally-update[key="'+aQ+'"][post-id="'+aP+'"]').prop("checked",aO);aN=G(aP)}aN[aQ]=aO;ar(aP,aN)}function z(aR,aO){if(aO){if("progress" in aO&&"keys" in aO){var aQ,aN;for(aQ in aO.progress){var aP=parseFloat(aO.progress[aQ]["pct"]),aS=parseInt(aO.progress[aQ]["count"]);aE(aQ,aP,aS);if(aP>=1){au('.progressally-status-display[post-id="'+aQ+'"]').show()}else{au('.progressally-status-display[post-id="'+aQ+'"]').hide()}}for(aQ in aO.keys){for(aN in aO.keys[aQ]){au('input[type="checkbox"].progressally-update[key="'+aN+'"][post-id="'+aQ+'"]').prop("checked",aO.keys[aQ][aN]==="true")}}if(progressally_update.user==="0"){d(aO.keys)}}if("popup" in aO&&aO.popup!==""){Y(aO.popup)}}}function P(aN,aO){if(aO&&"reset" in aO){if(aO.reset==="true"){au(".progressally-quiz-correct-message-"+aN).hide();au(".progressally-quiz-incorrect-message-"+aN).hide();au(".progressally-quiz-result-container-"+aN).empty().hide();au(".progressally-quiz-submit-button-"+aN).show();au(".progressally-quiz-current-page-"+aN).val("1").change();au(".progressally-quiz-choice-input-"+aN).prop("checked",false).prop("disabled",false);z(aN,aO);if(progressally_update.user==="0"&&"cookie" in aO){N(aN,aO.cookie)}}}}function ac(aO,aQ,aR){if(aR&&"quiz" in aR){var aP=aR.quiz;if("type" in aP&&"result-html" in aP){au(".progressally-quiz-result-container-"+aQ).html(aP["result-html"]).show();if(aP.type==="score"){for(var aN in aP.question){if(aP.question[aN]==="yes"){au("."+aN+"-correct-message-"+aQ).show()}else{au("."+aN+"-incorrect-message-"+aQ).show()}}}if(aR.reset==="true"){au(".progressally-quiz-reset-button-container-"+aQ).show()}au(".progressally-quiz-"+aQ+" .progressally-quiz-choice-input:not(:checked)").prop("disabled",true)}if("result-popup" in aP&&aP["result-popup"]!==""){Y(aP["result-popup"])}if(progressally_update.user==="0"&&"cookie" in aR){N(aQ,aR.cookie)}}z(aQ,aR)}function aE(aP,aO,aQ){var aN=au('[progressally-bar-update="'+aP+'"]'),aR=Math.round(aO*100)+"%";aN.find(".progressally_progress_bar_overlay").css("width",aR);aN.find(".progressally_progress_bar_percentage").text(aR);aN=au('[progressally-text-update="'+aP+'"]');aN.text(aR);aN=au('[progressally-count-update="'+aP+'"]');aN.text(aQ);aN=au('[progressally-pie-update="'+aP+'"]');if(aO>0.5){aN.find(".progressally_progress_pie_right").css("transform","rotate(90deg)");aN.find(".progressally_progress_pie_left").css("transform","rotate("+(Math.round((aO-0.5)*360)-90)+"deg)")}else{aN.find(".progressally_progress_pie_right").css("transform","rotate("+(Math.round(aO*360)-90)+"deg)");aN.find(".progressally_progress_pie_left").css("transform","rotate(-90deg)")}aN.find(".progressally_progress_pie_percentage").text(aR);aN=au('[progressally-objective-completion-update="'+aP+'"]');aN.each(function(aU,aV){var aT=au(aV),aS=parseFloat(aT.attr("percentage"));if(aO>=aS/100){aT.show()}else{aT.hide()}})}function U(aQ,aP){var aN="",aO=JSON.stringify(aP);date=new Date();date.setTime(date.getTime()+(PROGRESS_COOKIE_DAYS*24*60*60*1000));aN="; expires="+date.toGMTString();document.cookie=aQ+"="+aO+aN+"; path=/"}function j(aQ){if(aQ){var aP=aQ+"=",aO=document.cookie,aN=aO.indexOf(aP);if(aN>=0){aN+=aP.length;endIndex=aO.indexOf(";",aN);if(endIndex<0){endIndex=aO.length}return aO.substring(aN,endIndex)}}return null}function N(aN,aO){var aP=E();if(!(aN in aP)){aP[aN]=new Object}if(aP[aN]===null||typeof aP[aN]!=="object"||aP[aN] instanceof Array){aP[aN]=new Object}aP[aN]["quiz"]=aO;U(PROGRESS_COOKIE_NAME,aP)}function V(aN,aQ){var aP=E(),aO=false;if(!(aN in aP)){aP[aN]=new Object}if(aP[aN]===null||typeof aP[aN]!=="object"||aP[aN] instanceof Array){aP[aN]=new Object}if("quiz" in aP[aN]){aO=aP[aN]["quiz"]}if(aQ===null||typeof aQ!=="object"||aQ instanceof Array){aP[aN]=new Object}else{aP[aN]=aQ}if(false!==aO){aP[aN]["quiz"]=aO}U(PROGRESS_COOKIE_NAME,aP)}function d(aS){var aQ=v(),aO,aN,aR=[],aP;for(aO in aS){if(!(aO in aQ)){aQ[aO]=new Object}for(aN in aS[aO]){if("true"===aS[aO][aN]){aQ[aO][aN]="true"}else{if(aN in aQ[aO]){delete aQ[aO][aN]}}}if(au.isEmptyObject(aQ[aO])){aR.push(aO)}}for(aP=0;aP<aR.length;++aP){delete aQ[aR[aP]]}U(PROGRESS_OBJECTIVE_COOKIE_NAME,aQ)}function v(){var aN=JSON.parse(j(PROGRESS_OBJECTIVE_COOKIE_NAME));if(aN===null||typeof aN!=="object"||aN instanceof Array){aN=new Object}return aN}function E(){var aN=JSON.parse(j(PROGRESS_COOKIE_NAME));if(aN===null||typeof aN!=="object"||aN instanceof Array){aN=new Object}return aN}function x(){if(progressally_update.user==="0"){return E()}return progressally_update.user_meta}function r(aN,aO){if(progressally_update.user==="0"){V(aN,aO)}else{progressally_update.user_meta[aN]=aO}}function aB(){var aN=x();au(".progressally-toggle-trigger").each(function(aO,aP){Z(au(aP),aN)})}function Z(aN,aW){var aU=aN.attr("key").split(","),aV=aN.attr("unchecked-class"),aT=aN.attr("checked-class"),aQ=aN.attr("selector"),aO=au(aQ),aR=0,aP=aN.attr("post-id"),aS=true;if(!(aP in aW)){aS=false}else{aW=aW[aP];for(aR=0;aR<aU.length;aR++){if(!(aU[aR] in aW)||aW[aU[aR]]==="false"){aS=false;break}}}if(typeof aT!==typeof undefined&&aT!==false){if(aS){aO.addClass(aT)}else{aO.removeClass(aT)}}if(typeof aV!==typeof undefined&&aV!==false){if(aS){aO.removeClass(aV)}else{aO.addClass(aV)}}}au(document).on("change",".progressally-toggle",function(aN){q(au(this))});var O={};function q(aS){var aU=aS,aP=parseInt(aU.attr("post-id")),aR=aU.attr("key"),aO=aU.val(),aT=null,aN={};if(aU.is('[type="checkbox"]')){aO=aU.is(":checked")?true:false}aN[aR]=aO;aT={action:"progressally_update_toggle",p:aP,v:aN,nonce:progressally_update.progressally_update_nonce};if(!(aP in O)){O[aP]=0}var aQ=++O[aP];au.ajax({type:"POST",url:progressally_update.ajax_url,data:aT,success:function(aW){try{if(O[aP]===aQ){var aV=JSON.parse(aW);n(aP,aR,aV);O[aP]=0}}catch(aX){}}})}function n(aR,aQ,aO){if(aO){if("meta" in aO){var aP={},aN=false;aP[aR]=aO.meta;r(aR,aO.meta);au('.progressally-toggle-trigger[post-id="'+aR+'"][key="'+aQ+'"]').each(function(aS,aT){Z(au(aT),aP)});if(aQ in aO.meta&&"true"===aO.meta[aQ]){aN=true}au('input.progressally-toggle[post-id="'+aR+'"][key="'+aQ+'"]').prop("checked",aN)}}}function av(){if(!ab()){var aN=document.createElement("script");aN.src="https://www.youtube.com/iframe_api";var aO=document.getElementsByTagName("script")[0];aO.parentNode.insertBefore(aN,aO)}}function k(aO){var aN={};if(aO){var aR=aO.split("&"),aP,aQ;for(aP=0;aP<aR.length;++aP){aQ=aR[aP].split("=");if(aQ.length>1){aN[aQ[0]]=aQ[1]}}}return aN}function ab(){return typeof YT!=="undefined"&&typeof YT.Player!=="undefined"}var b={},w={};function F(aP,aQ,aW){var aO=aP.attr("width"),aU=aP.attr("height"),aV=aP.attr("arg"),aN=k(aV),aS="progressally-youtube-div-"+aQ+"-"+aW,aR={videoId:aQ,playerVars:aN,events:{onStateChange:f}},aT;aP.html('<div id="'+aS+'"></div>');if(aO){aR.width=aO}if(aU){aR.height=aU}aT=new YT.Player(aS,aR);aT.progressally_video_id=aW;b[aW]=aT}function am(){if(ab()){au("[progressally-youtube-init]").each(function(aO,aP){var aN=au(aP),aR=aN.attr("progressally-youtube-init"),aQ=aN.attr("progressally-youtube-id");F(aN,aR,aQ)})}else{setTimeout(am,1000)}}function f(aP){var aN=aP.data,aO=aP.target.progressally_video_id;if(aN>0){w[aO]=true}if(1===aN){ai(aO,aP.target)}else{u(aO,aP.target)}aF(aO,aP.target)}function g(aO,aN){var aQ=au(aN),aR=aQ.attr("progressally-video-id"),aP=aQ.attr("progressally-video-time");c(aR,aP,aQ);R(au('[progressally-youtube-id="'+aR+'"]'));aO.stopPropagation();return false}function i(aN){if(aN in w){return true}return false}function c(aT,aS,aR){if(!i(aT)){t(aR);t(au('[progressally-youtube-id="'+aT+'"]'));return false}if(ab()&&aT in b){b[aT].seekTo(aS,true);return true}else{var aO=au("#progressally_youtube_"+aT);if(aO.length!==1){return false}var aQ=aO.attr("youtube_id"),aP=JSON.stringify({event:"command",func:"seekTo",args:[aS,true]}),aN="https://www.youtube.com/embed/"+aQ;aO=aO[0];aO.contentWindow.postMessage(aP,aN);return true}}var S={};function ai(aN,aO){if(aN in S&&false!==S[aN]){u(aN,aO)}S[aN]=setInterval(function(){aF(aN,aO)},1000)}function u(aN,aO){clearInterval(S[aN]);S[aN]=false}function aF(aN,aO){aL("youtube>"+aN,aO.getCurrentTime())}function I(){return typeof Vimeo!=="undefined"&&typeof Vimeo.Player!=="undefined"}function aA(){if(!I()){var aN=document.createElement("script");aN.src="https://player.vimeo.com/api/player.js";var aO=document.getElementsByTagName("script")[0];aO.parentNode.insertBefore(aN,aO)}}function aG(){if(I()){au("[progressally-vimeo-init]").each(function(aO,aP){var aN=au(aP),aQ=aN.attr("progressally-vimeo-init");aI(aN,aQ)})}else{setTimeout(aG,1000)}}var ag={},B={};function aI(aN,aQ){if(!(aQ in ag)){try{var aP=new Vimeo.Player(aN[0]);aP.progressally_video_id=aQ;aP.on("play",function(aR){aC(this.progressally_video_id)});if(("vimeo>"+aQ) in progressally_update.video){aP.on("timeupdate",function(aR){ak(aR,this)});aP.on("pause",function(aR){ak(aR,this)});aP.on("ended",function(aR){ak(aR,this)})}ag[aQ]=aP}catch(aO){}}}function aC(aN){if(aN){B[aN]=true}}function ah(aO,aN){var aQ=au(aN),aR=aQ.attr("progressally-video-id"),aP=aQ.attr("progressally-video-time");ae(aR,aP,aQ);R(au('[progressally-vimeo-id="'+aR+'"]'));aO.stopPropagation();return false}function D(aN){if(az()){if(aN in B){return true}return false}return true}function ae(aR,aQ,aP){var aN=au('[progressally-vimeo-id="'+aR+'"]'),aO;aI(aN,aR);if(!(aR in ag)){return false}aO=ag[aR];if(D(aR)){aO.setCurrentTime(aQ);aO.play()}else{t(aP);t(aN);return false}return true}function ak(aN,aO){aL("vimeo>"+aO.progressally_video_id,aN.seconds)}function aa(){if(typeof Wistia==="undefined"){var aN=document.createElement("script");aN.src="//fast.wistia.net/assets/external/E-v1.js";var aO=document.getElementsByTagName("script")[0];aO.parentNode.insertBefore(aN,aO)}}var aH={},C={},aJ={};function aj(){var aN=au(this.iframe).attr("progressally-wistia-video-id");if(aN){C[aN]=true}}function ao(){window._wq=window._wq||[];_wq.push({id:"_all",onReady:function(aN){var aP=au(aN.iframe),aO=aP.attr("progressally-wistia-video-id");aH[aO]=aN;aN.bind("play",aj);if(("wistia>"+aO) in progressally_update.video){aN.bind("timechange",T);aN.bind("pause",T);aN.bind("end",T)}if(aO in aJ){var aQ=aJ[aO];h(aO,aQ[0],aQ[1]);delete aJ[aO]}}})}function m(aO,aN){var aQ=au(aN),aR=aQ.attr("progressally-video-id"),aP=aQ.attr("progressally-video-time");h(aR,aP,aQ);R(au('[progressally-wistia-id="'+aR+'"]'));aO.stopPropagation();return false}function y(aN){if(az()){if(aN in C){return true}return false}return true}function h(aP,aO,aN){if(aP in aH){if(y(aP)){aH[aP].time(aO).play()}else{t(aN);t(au('[progressally-wistia-id="'+aP+'"]'));return false}return true}else{if(!(aP in aJ)){aJ[aP]=[aO,aN]}}return false}function T(aO){var aP=au(this.iframe),aN=aP.attr("progressally-wistia-video-id");aL("wistia>"+aN,aO)}function t(aN){var aO=au('<div style="position:absolute;top:10px;padding:5px;border-radius:5px;border:1px solid #000000;opacity:0;background-color:#ffffff;z-index:9999999;">Please start the video first.</div>');aN.css("position","relative");aN.append(aO);aO.animate({opacity:1},200);setTimeout(function(){aO.animate({opacity:0},1000,function(){aO.remove()})},1000)}function az(){return navigator.userAgent.match(/(iPad|iPhone|iPod)/g)}var e=0;au(document).on("click touchend","[progressally-notes-update]",function(aP){var aO=au(this),aN=aO.attr("progressally-notes-update");Q(aN)});au(document).on("click touchend","[progressally-notes-update-display]",function(aP){var aO=au(this),aN=aO.attr("progressally-notes-update-display");Q(aN)});au(document).on("keydown","[progressally-notes-value]",function(aP){if(aP.keyCode==27){aP.preventDefault();var aO=au(this),aN=aO.attr("progressally-notes-value");a(aN);aO.blur();return false}});au(document).on("click touchend","[progressally-notes-input-save]",function(aO){var aN=au(this).attr("progressally-notes-input-save");W(aN)});au(document).on("click touchend","[progressally-notes-input-cancel]",function(aO){var aN=au(this).attr("progressally-notes-input-cancel");a(aN)});function Q(aN){++e;au('[progressally-notes-update-display-container="'+aN+'"]').hide();var aO=au('[progressally-notes-value="'+aN+'"]'),aP=p(aO.val());aP=Math.min(20,Math.max(aP+1,8));aO.prop("rows",aP);au('[progressally-notes-input-container="'+aN+'"]').show();au('[progressally-notes-value="'+aN+'"]').focus().select()}function a(aN){au('[progressally-notes-update-display-container="'+aN+'"]').show();au('[progressally-notes-input-container="'+aN+'"]').hide();au('[progressally-notes-value="'+aN+'"]').blur();--e}function A(aP){var aN=[],aO=0;for(;aO<aP.length;++aO){if(aP[aO].files.length>0){aN.push(aP[aO].files[0])}}return aN}function al(aN){--e;au('[progressally-notes-update-display-container="'+aN+'"]').show();au('[progressally-notes-input-container="'+aN+'"]').hide();au('[progressally-notes-wait="'+aN+'"]').hide();au('[progressally-notes-value="'+aN+'"]').blur()}function W(aU){var aR=au('[progressally-notes-value="'+aU+'"]'),aP=aR.val(),aQ=aR.attr("post-id"),aY=aR.attr("note-id"),aV=aR.attr("ordinal"),aO=aR.attr("note-ordinal"),aX=au("#progressally-private-note-"+aO).attr("progressally-note-param"),aW=au('[progress-note-attachment-file="'+aU+'"]'),aN=H(aO,aV),aS=A(aW);au('[progressally-notes-wait="'+aU+'"]').show();if(aP.length<=0&&aS.length>0){aP=" "}var aT={action:"progressally_notes_update",val:aP,pid:aQ,nid:aY,ord:aV,att:aN.join(","),attr:aX};au.ajax({type:"POST",url:progressally_update.ajax_url,data:aT,success:function(aZ){try{aD(aZ,aQ,aY,aV,aO,aU,aS)}catch(a0){alert(a0);al(aU)}}});return false}function aK(aY,aR,aX){if(!("code" in aY)){throw"Unable to update note display"}var aP="progressally-private-note-p"+aR+"t-n"+aX+"e",aS=au("["+aP+"]"),aT=0,aV,aU,aQ,aW,aN,aO;for(;aT<aS.length;++aT){aV=au(aS[aT]);aU=aV.attr("progressally-note-customize");aQ=au.parseJSON(aU);aN=aY.code;for(aW in aQ){aN=aN.replace(new RegExp("--"+aW+"--","g"),aQ[aW])}aO=au(aN);aO.attr("progressally-note-customize",aU);aV.after(aO);aV.remove()}}function aD(aP,aQ,aS,aO,aU,aT,aR){var aN=JSON.parse(aP);if("status" in aN){if(aN.status==="error"){throw aN.message}if("data" in aN){if(progressally_update.user==="0"){U(aN.data["key"],aN.data["notes"])}}if("progress" in aN){z(aQ,aN.progress)}if(aR.length>0){ax(aQ,aS,aO,aU,aT,0,aR)}else{aK(aN,aQ,aS)}}else{throw"Invalid response. Please refresh the page and try again."}}function p(aN){var aO=aN.match(/(\r\n|\n\r|\r|\n)/g);if(null===aO){return 1}return aO.length+1}function at(aN){aN=aN.replace(/&/g,"&amp;");aN=aN.replace(/</g,"&lt;");aN=aN.replace(/>/g,"&gt;");aN=aN.replace(/\'/g,"&#39;");aN=aN.replace(/\"/g,"&quot;");aN=aN.replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1<br/>$2");return aN}function ax(aQ,aU,aT,aO,aP,aS,aR){if(aS>=aR.length){al(aP);return}var aN=aR[aS],aV="slice";if("mozSlice" in aN){aV="mozSlice"}else{if("webkitSlice" in aN){aV="webkitSlice"}}aM(0,aN,aV,aQ,aU,aT,aO,-1,0,function(aW){if(aS===aR.length-1){aK(aW,aQ,aU)}else{ax(aQ,aU,aT,aO,aP,aS+1,aR)}})}var M=102400;function aM(aR,aP,a2,aQ,a1,aX,aO,aT,aZ,a0){var aN=aR*M,aS=aN+M,aW=aP.size;if(aS>aW){aS=aW}var aV=aP[a2](aN,aS),aU=new FormData(),aY=au("#progressally-private-note-"+aO).attr("progressally-note-param");aU.append("action","progressally_notes_add_attachment");aU.append("nonce",progressally_update.progressally_update_nonce);aU.append("index",aR);aU.append("file_name",aP.name);aU.append("content",aV);aU.append("pid",aQ);aU.append("nid",a1);aU.append("ord",aX);aU.append("attr",aY);if(aT){aU.append("aid",aT)}au.ajax({type:"POST",url:progressally_update.ajax_url,data:aU,cache:false,contentType:false,processData:false,success:function(a3){l(a3,aS,aR,aP,a2,aW,aQ,a1,aX,aO,aT,aZ,a0)}})}function l(aR,aS,aQ,aO,a1,aW,aP,aZ,aV,aN,aT,aX,aY){try{var a0=JSON.parse(aR);if("status" in a0){if(a0.status==="retry"){aX+=1;if(aX>3){throw"Upload failed 3 times"}aM(aQ,aO,a1,aP,aZ,aV,aN,aT,aX,aY);return}else{if(a0.status!=="success"){throw a0.message}}}else{throw"Unable to connect to server"}if(aS<aW){aM(aQ+1,aO,a1,aP,aZ,aV,aN,a0.aid,0,aY)}else{aY(a0)}}catch(aU){alert("Cannot upload file due to error:\n["+aU+"]\nPlease refresh the page and try again.");return}}au(document).on("click touchend","[progressally-notes-attachment-add]",function(){var aN=au(this).attr("progressally-notes-attachment-add");au('[progressally-notes-attachment-container="'+aN+'"]').append('<input class="progress-note-attachment-file-input" type="file" progress-note-attachment-file="'+aN+'" />')});au(document).on("click touchend",".progressally-notes-display-attachment-link",function(aN){aN.stopPropagation()});var X=10485760;au(document).on("change","[progress-note-attachment-file]",function(){if(this.files.length>0){var aN=this.files[0].name.toLowerCase();if(aN.substring(aN.length-4)===".php"){alert("PHP files cannot be uploaded");au(this).val("")}if(this.files[0].size>X){alert("The attachment file cannot exceed 10MB in size.");au(this).val("")}}});au(document).on("click touchend","[progressally-notes-attachment-delete]",function(){var aN=au(this).attr("progressally-notes-attachment-delete");au("#progressally-note-attachment-"+aN).remove()});function H(aT,aO){var aN=[],aQ="progressally-notes-existing-attachment-"+aT+"-"+aO,aS=au("["+aQ+"]"),aR=0,aP;for(;aR<aS.length;++aR){aP=au(aS[aR]);aN.push(aP.attr(aQ))}return aN}function ay(){aB();if(au("[progressally-youtube-init]").length>0){av();setTimeout(am,500)}if(au("[progressally-vimeo-init]").length>0){aA();setTimeout(aG,500)}if(au("[progressally-wistia-init]").length>0){aa();ao()}if(!au.isFunction(au.fn.on)){an(".progressally-quiz-reset-button",J);an(".progressally-quiz-submit-button",ad);an('[progressally-video-target="vimeo"]',ah);an('[progressally-video-target="youtube"]',g);an('[progressally-video-target="wistia"]',m)}}if(au.isFunction(au.fn.on)){au("html").on("touchend click",".progressally-quiz-reset-button",function(aN){return o(aN,this,J)});au("html").on("touchend click",".progressally-quiz-submit-button",function(aN){return o(aN,this,ad)});au("html").on("touchend click",'[progressally-video-target="vimeo"]',function(aN){return o(aN,this,ah)});au("html").on("touchend click",'[progressally-video-target="youtube"]',function(aN){return o(aN,this,g)});au("html").on("touchend click",'[progressally-video-target="wistia"]',function(aN){return o(aN,this,m)})}ay();function af(aP){var aO=aP[0].getBoundingClientRect();if(aO.top<0){var aQ=aP.offset(),aN=aQ.top-20;au("html, body").animate({scrollTop:aN})}}au(document).on("click touchend",".progressally-quiz-next-button",function(aQ){var aP=au(this),aR=au("#"+aP.attr("progressally-validate")),aO=au("#"+aP.attr("progressally-nav-target")),aN=aP.attr("progressally-nav-value");if(!L(aR)){return false}aO.val(aN).change();af(aP.parents(".progressally-quiz"))});au(document).on("click touchend",".progressally-quiz-back-button",function(aP){var aO=au(this),aN=au("#"+aO.attr("progressally-nav-target")),aQ=aO.attr("progressally-nav-value");aN.val(aQ).change();af(aO.parents(".progressally-quiz"))});if(document.addEventListener){document.addEventListener("ambitionallyrefresh",function(aN){ay()},false)}else{if(document.attachEvent){document.attachEvent("ambitionallyrefresh",function(aN){ay()})}}au(document).on("click touchend","[progressally-complete-button]",function(aU){var aV=au(this),aQ=aV.attr("progressally-complete-button"),aW={},aS,aR,aP,aT,aO,aN;if(typeof aQ===typeof undefined||aQ===false){return}aS=aQ.split("|");if(aS.length<2){return}aR=aS[0];aP=aS[1].split(",");for(aT=0;aT<aP.length;++aT){aO=au('.progressally-update[key="'+aP[aT]+'"][post-id="'+aR+'"]');aN=aO.attr("disabled");if(typeof aN===typeof undefined||aN===false){aO.prop("checked",true)}}aW=G(aR);for(aT=0;aT<aP.length;++aT){aW[aP[aT]]=true}ar(aR,aW)});function R(aO){if(!aO.is(":visible")){return}var aP=aO.offset(),aN=aP.top-20;au("html, body").animate({scrollTop:aN})}function aL(aT,aP){if(aT in progressally_update.video){var aO,aR=[],aU=[],aQ,aS,aN,aV;for(aS in progressally_update.video[aT]){aO=progressally_update.video[aT][aS]["time"];if(aP>=aO){aR.push(progressally_update.video[aT][aS]["obj"]);aU.push(aS)}}if(aR.length<=0){return}aQ=progressally_update.post_id;for(aS=0;aS<aR.length;++aS){aN=au('.progressally-update[key="'+aR[aS]+'"][post-id="'+aQ+'"]');aN.prop("checked",true);delete progressally_update.video[aT][aU[aS]]}aV=G(aQ);for(aS=0;aS<aR.length;++aS){aV[aR[aS]]=true}ar(aQ,aV)}}au("[progressally-local-time]").each(function(aQ,aS){var aO=au(aS),aT=aO.attr("progressally-local-time");if(aT.length<=0){return}var aP=new Date(parseInt(aT)*1000),aR=aP.toString(),aU=aR.indexOf("GMT"),aN=-1;if(aU>=0){aN=aR.indexOf(" ",aU);if(aN>0){aR=aR.replace(aR.substring(aU,aN),"")}}aO.text(aR)});function Y(aO){try{if(typeof window.Event==="function"){var aN=new CustomEvent("popupallyshowpopup",{detail:{popup_id:aO}});document.dispatchEvent(aN)}else{if(typeof document.createEvent==="function"){var aN=document.createEvent("CustomEvent");aN.initCustomEvent("popupallyshowpopup",true,true,{popup_id:aO});document.dispatchEvent(aN)}}}catch(aP){}}});