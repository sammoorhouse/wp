function add_field(){var e=document.getElementById("field_box"),t=document.getElementById("field_next").value,o=document.createElement("div");o.setAttribute("id","field_div"+t),o.setAttribute("class","sortable");var n=document.createElement("span");n.setAttribute("class","bp_ps_col1"),n.setAttribute("title",window.bp_ps_strings.drag),n.appendChild(document.createTextNode(" ⇅"));var d=jQuery("<select>",{name:"bp_ps_options[field_name]["+t+"]",id:"field_name"+t});d.addClass("bp_ps_col2"),d.addClass("new_field"),jQuery("<option>",{text:window.bp_ps_strings.field,value:0}).appendTo(d),jQuery.each(window.bp_ps_groups,function(e,t){jQuery.each(t,function(e,t){var o=jQuery("<optgroup>",{label:e});o.appendTo(d),jQuery.each(t,function(e,t){jQuery("<option>",{text:t.name,value:t.id}).appendTo(o)})})});var i=document.createElement("a");i.setAttribute("href",'javascript:remove("field_div'+t+'");'),i.setAttribute("class","delete"),i.appendChild(document.createTextNode(window.bp_ps_strings.remove)),e.appendChild(o),o.appendChild(n),o.appendChild(document.createTextNode("\n")),d.appendTo("#field_div"+t),o.appendChild(document.createTextNode("\n")),o.appendChild(i),enableSortableFieldOptions(),document.getElementById("field_name"+t).focus(),document.getElementById("field_next").value=++t}function remove(e){var t=document.getElementById(e);if(0===document.querySelectorAll("body.post-type-bp_ps_form #postbox-container-2 #normal-sortables #bp_ps_fields_box .inside #field_box .sortable").length-1){var o=document.getElementById("empty-box-alert").value;return window.alert(o),!1}t.parentNode.removeChild(t)}function enableSortableFieldOptions(){jQuery(".field_box").sortable({items:"div.sortable",tolerance:"pointer",axis:"y",handle:"span"})}jQuery(document).ready(function(){enableSortableFieldOptions()}),jQuery(document).ready(function(e){e("#template").change(function(){var t=e("#bp_ps_template .spinner"),o=e("input[type=submit]"),n={action:"template_options",form:e("#form_id").val(),template:e("#template option:selected").val()};o.attr("disabled","disabled"),t.addClass("is-active"),e.post(ajaxurl,n,function(n){e("#template_options").html(n),t.removeClass("is-active"),o.removeAttr("disabled")})}),jQuery(document).on("change","body.post-type-bp_ps_form #postbox-container-2 #normal-sortables #bp_ps_fields_box .inside #field_box .sortable .bp_ps_col2.new_field",function(){var t=this.value,o=e("body.post-type-bp_ps_form #postbox-container-2 #normal-sortables #bp_ps_fields_box .inside #field_next").val(),n={action:"bp_search_ajax_option",field_id:t,count:o};e.post(ajaxurl,n,function(t){e("body.post-type-bp_ps_form #postbox-container-2 #normal-sortables #bp_ps_fields_box .inside #field_box #field_div"+(o-1)).remove(),e("body.post-type-bp_ps_form #postbox-container-2 #normal-sortables #bp_ps_fields_box .inside #field_box").append(t)})}),jQuery(document).on("change","body.post-type-bp_ps_form #postbox-container-2 #normal-sortables #bp_ps_fields_box .inside #field_box .sortable .bp_ps_col2.existing",function(){var e=jQuery(this).find("option:selected").text(),t=jQuery(this).parent().closest("div").attr("id");jQuery("#"+t+" .bp_ps_col3").attr("placeholder",e)})});