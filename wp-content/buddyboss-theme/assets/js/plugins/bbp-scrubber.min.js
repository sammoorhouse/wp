/*! 
 * BuddyBoss Theme JavaScript Library 
 * @package BuddyBoss Theme 
 */
!function(u){"use strict";window.BuddyBossThemeBbpScrubber={total:0,onscroll_update:!0,scrubber_height_usable:0,scrubber_height:0,currentnum:1,scrolltimer:null,handleani:null,draggie:null,init:function(){var e=window.BuddyBossThemeBbpScrubber;e.total=u(".scrubberpost").length,e.scrubber_height=u("#reply-timeline-container").outerHeight(),e.scrubber_height_usable=e.scrubber_height-u("#handle").outerHeight(),e.total<3&&u(".scrubber").addClass("light"),e.init_draggabilly(),window.addEventListener("scroll",e.onScrubberScroll),u(".scrubber").on("click",".firstpostbtn",function(t){t.preventDefault(),e.goToPost(1,"first")}),u(".scrubber").on("click",".lastpostbtn",function(t){t.preventDefault(),e.goToPost(e.total,"last")})},init_draggabilly:function(){var e=window.BuddyBossThemeBbpScrubber;e.draggie=u("#handle").draggabilly({axis:"y",grid:[1,1],containment:"#reply-timeline-container"}),e.draggie.on("dragEnd",function(){u("#handle").removeClass("animate");var t="";1===e.currentnum?t="first":e.currentnum===e.total&&(t="last"),e.goToPost(e.currentnum,t)}),e.draggie.on("dragMove",function(){e.update_move()}),e.draggie.on("scroll",function(){e.update_move()}),e.updateDataOnFront()},updateDataOnFront:function(){var t=window.BuddyBossThemeBbpScrubber;t.total=u(".scrubberpost").length,u("#currentpost").text(t.currentnum),u("#totalposts").text(t.total);var e=document.getElementsByClassName("scrubberpost")[t.currentnum-1];u(".scrubber #date").text(u(e).data("date"))},goToPost:function(t,e){var n=window.BuddyBossThemeBbpScrubber,r=document.getElementsByClassName("scrubberpost");if(!r.length)return!1;n.total=r.length,(n.currentnum=t)>r.length||1!==n.total&&t===n.total?(t=n.total-1,e="last"):1===t&&"last"!==e?(t=0,e="first"):1===t&&"last"===e?t=0:t-=1,0===t?n.currentnum=t+1:t===n.total&&(n.currentnum=n.total);var o=!1;"last"===e?t=n.total-1:"first"===e&&(o=!(t=0)),n.onscroll_update=!1;var a=0;void 0===r[t]?a=r[r.length]:(a=r[t],u(a).parent().addClass("highlight")),n.update_handle(o),u("html, body").animate({scrollTop:u(a).offset().top-window.innerHeight/2},600,function(){setTimeout(function(){u(a).parent().removeClass("highlight"),n.onscroll_update=!0},200)})},update_move:function(){var t=window.BuddyBossThemeBbpScrubber;t.total=u(".scrubberpost").length,t.scrubber_height_usable=t.scrubber_height-u("#handle").outerHeight();var e=t.scrubber_height_usable,n=document.getElementById("handle").style.transform.split(",")[1];n=void 0!==n?n:0;for(var r=parseFloat(document.getElementById("handle").style.top)+parseFloat(n),o=parseFloat(e/t.total),a=1;a<=t.total;a++)r<o*a&&o*(a-1)<r&&(t.currentnum=a,t.updateDataOnFront())},update_handle:function(t){var e=window.BuddyBossThemeBbpScrubber,n=u("#handle");if(!n.length)return!1;e.updateDataOnFront(),e.scrubber_height_usable=e.scrubber_height-n.outerHeight();var r=e.scrubber_height_usable/e.total;1!==e.currentnum||1===e.total&&!t||(r=0),n.addClass("animate"),n.css("top",r*e.currentnum+"px"),clearTimeout(e.handleani),e.handleani=setTimeout(function(){n.length||n.removeClass("animate")},2e3)},onScrubberScroll:function(){var t=window.BuddyBossThemeBbpScrubber;if(!t.onscroll_update)return!1;var e=document.getElementsByClassName("scrubberpost");if(!e.length)return!1;if(window.scrollY+window.innerHeight.height/2<e[0].getBoundingClientRect().y||0===window.scrollY)return t.currentnum=1,t.update_handle(!0),!1;if(window.scrollY+window.innerHeight>=document.body.scrollHeight){t.currentnum=t.total;var n=1!==t.total;return t.update_handle(n),!1}for(var r=t.currentnum,o=!1,a=0;a<e.length;a++)e[a].getBoundingClientRect().y<window.innerHeight/2&&(o=!0,r=a);r+1>t.total&&(r=t.total-1),o&&(t.currentnum=r+1,t.update_handle(!1))}},u(document).on("ready",function(){window.BuddyBossThemeBbpScrubber.init()})}(jQuery);